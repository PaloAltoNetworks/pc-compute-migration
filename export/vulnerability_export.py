from export import rules_export

from pcpi import session_loader

session_managers = session_loader.load_config(file_path="vuln_export_creds.json")

session = session_managers[0].create_cwp_session()

def export_rules():
    rules_export.export(session, 'Vulnerability Rules - Code Repositories - Repositories - Rule', '/api/v1/policies/vulnerability/coderepos', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Code Repositories - CI Rule', '/api/v1/policies/vulnerability/ci/coderepos', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Images - Deployed', '/api/v1/policies/vulnerability/images', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Images - CI', '/api/v1/policies/vulnerability/ci/images', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Images - Base Images', '/api/v1/policies/vulnerability/base-images', '')

    rules_export.export(session, 'Vulnerability Rules - Hosts - Host', '/api/v1/policies/vulnerability/host', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Hosts - VM', '/api/v1/policies/vulnerability/vms', 'rules')

    rules_export.export(session, 'Vulnerability Rules - Functions - Function', '/api/v1/policies/compliance/serverless', 'rules')